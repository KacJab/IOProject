{% extends 'base.html' %}
{% block content %}
    <div class="container px-4 px-lg-5 d-flex h-100 align-items-center justify-content-center">
        <div class="d-flex justify-content-center">
            <div class="grid-container">
                <div class="col-5 grid-child">
                    <table class="table table-bordered table-dark" id="yourboard">
                    </table>
                </div>

                <div class=" col-5 grid-child">
                    <table class="table table-bordered table-dark" id="enemyboard">
                    </table>
                </div>
            </div>
        </div>
    </div>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
    <script>
        var board = [];
        var fleet = [];

        for (let i = 0; i < 10; i++) {
            board[i] = [];
            for (let j = 0; j < 10; j++) {
                board[i][j] = 0;
            }
        }

        for (let i = 0; i < 4; i++) {
            for (let j = 0; j < 4 - i; j++) {
                fleet.push(i + 1)
            }
        }


        function randomly_locate_ships(board, fleet) {
            var sum = 0;
            while (sum < 20) {
                var xd = 1;

                for (let i = 0; i < fleet.length; i++) {
                    orient = Math.round(Math.random());
                    place_start = Math.floor(Math.random() * (10 - fleet[i]));
                    place_on_axis2 = Math.floor(Math.random() * 10);

                    for (let s = 1; s <= fleet[i]; s++) {
                        if (orient == 1) {
                            board[place_start + s][place_on_axis2] = xd;
                        } else {
                            board[place_on_axis2][place_start + s] = xd;
                        }
                    }
                }
                for (let i = 0; i < 10; i++) {
                    for (let j = 0; j < 10; j++) {
                        if (board[i][j] != 0) {
                            sum++;
                        }
                    }
                }
                if (sum < 20) {
                    for (let i = 0; i < 10; i++) {

                        for (let j = 0; j < 10; j++) {
                            board[i][j] = 0;
                        }
                    }
                }
                console.log(sum);
            }
        }

        function createBoard(div1, div2) {
            var tbl = div1;
            var tbl2 = div2;

            var tblBody = document.createElement("tbody");
            var tblBody2 = document.createElement("tbody");

            for (var j = 0; j < 11; j++) {
                var row = document.createElement("tr");
                var row2 = document.createElement("tr");

                for (var i = 0; i < 11; i++) {

                    var cell = document.createElement("td");
                    var cell2 = document.createElement("td");

                    var cellText2 = document.createTextNode("0");
                    cellText2.className = "enemys-field";
                    cellText2.id = toString(i)+","+toString(j);
                    if(j == 0 && i != 0) {
                        var cellText = document.createTextNode(i);
                        var cellText2 = document.createTextNode(i);
                    }else if(j== 0 && i == 0){
                        var cellText = document.createTextNode("X");
                        var cellText2 = document.createTextNode("X");
                    }else if(i == 0){
                        var cellText = document.createTextNode(String.fromCharCode(64+j));
                        var cellText2 = document.createTextNode(String.fromCharCode(64+j));
                    }else{
                        var cellText = document.createTextNode(board[i-1][j-1]);
                        cellText.className = "your-field"
                    }

                    cell.appendChild(cellText);
                    cell2.appendChild(cellText2)
                    row.appendChild(cell);
                    row2.appendChild(cell2);
                }

                //row added to end of table body
                tblBody.appendChild(row);
                tblBody2.appendChild(row2);
            }

            // append the <tbody> inside the <table>
            tbl.appendChild(tblBody);
            tbl2.appendChild(tblBody2);

            tbl.setAttribute("border", "2");
            tbl2.setAttribute("border", "2");
        }

        randomly_locate_ships(board, fleet);
        console.log(board);
        console.log(fleet);
        createBoard(document.getElementById("yourboard"), document.getElementById("enemyboard"));

        $(document).ready(function () {
            $("enemys-field").click(function () {
                let rowcol = this.id.split(',');
                let r = rowcol[0];
                let c = rowcol[1];
                alert(r + ' ' + c);
                if (this.className === "enemys-field") {
                    this.className = "field checkedfield";
                } else {

                }
            });
        });
    </script>
{% endblock content %}